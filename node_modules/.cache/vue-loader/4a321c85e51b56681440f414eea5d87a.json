{"remainingRequest":"C:\\work\\求索2019\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\work\\求索2019\\admin\\src\\views\\coin\\index2.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\work\\求索2019\\admin\\src\\views\\coin\\index2.vue","mtime":1581669594656},{"path":"C:\\work\\求索2019\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\求索2019\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\work\\求索2019\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\work\\求索2019\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\n\r\nimport { recharge, check } from '@/api/card'\r\nimport { mapGetters } from 'vuex'\r\nimport { MessageBox } from 'element-ui'\r\nexport default {\r\n  name: 'Coin',\r\n  data() {\r\n    const validateCoin = (rule, value, callback) => {\r\n      if (typeof value !== 'number') {\r\n        callback(new Error('请输入5的倍数'))\r\n      }\r\n      if (value % 5 !== 0) {\r\n        callback(new Error('只能输入5的倍数'))\r\n      }\r\n      if (value < 5) {\r\n        callback(new Error('最小充值5金币'))\r\n      }\r\n\r\n      if (value > 1000) {\r\n        callback(new Error('最多充值1000金币'))\r\n      }\r\n      callback()\r\n    }\r\n    return {\r\n      form: {\r\n        rechargeCoin: 100,\r\n        pay_method: 0\r\n      },\r\n      rules: {\r\n        rechargeCoin: [{ required: true, trigger: 'blur', validator: validateCoin }],\r\n        pay_method: [{ required: true, message: '请选择支付方式', trigger: 'blur' }]\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.requestData()\r\n  }, computed: {\r\n    ...mapGetters([\r\n      'coin',\r\n      'name'\r\n    ])\r\n  },\r\n  methods: {\r\n    onSubmit() {\r\n      this.$refs['form'].validate((valid) => {\r\n        if (valid) {\r\n          recharge(this.form).then((res) => {\r\n            this.$message({\r\n              message: res.msg,\r\n              type: 'success'\r\n            })\r\n            this.form = {\r\n              card_name: '',\r\n              card_passwd: ''\r\n            }\r\n            this.requestData()\r\n          })\r\n        } else {\r\n          return false\r\n        }\r\n      })\r\n    },\r\n    requestData() {\r\n      this.$store.dispatch('user/getUserInfo')\r\n    },\r\n    checkCard() {\r\n      if (this.form.card_name === '') {\r\n        this.$message({\r\n          message: '卡号不能为空',\r\n          type: 'warning'\r\n        })\r\n        return\r\n      }\r\n      check({ card_name: this.form.card_name }).then((res) => {\r\n        if (res.status === 1) {\r\n          if (res.data.card_status === 0) {\r\n            this.$alert('该卡未使用')\r\n          } else if (res.data.card_status === 1) {\r\n            this.$alert('该卡已使用')\r\n          } else {\r\n            this.$alert('金币卡不存在')\r\n          }\r\n        } else {\r\n          this.$message({\r\n            message: '查询失败',\r\n            type: 'error'\r\n          })\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n",null]}