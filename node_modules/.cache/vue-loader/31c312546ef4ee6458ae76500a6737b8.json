{"remainingRequest":"F:\\Python\\autoComplete\\vue-admin-template\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\Python\\autoComplete\\vue-admin-template\\src\\views\\task\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\Python\\autoComplete\\vue-admin-template\\src\\views\\task\\index.vue","mtime":1572243740457},{"path":"F:\\Python\\autoComplete\\vue-admin-template\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\Python\\autoComplete\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\Python\\autoComplete\\vue-admin-template\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport axios from 'axios'\r\nimport { getInfo } from '@/api/user'\r\naxios.defaults.withCredentials = true\r\nexport default {\r\n  name: 'Task',\r\n  data() {\r\n    return {\r\n      visible1: false,\r\n      activeNames: ['1'],\r\n      user: {\r\n        user_invited_tick: 0,\r\n        coin: 0\r\n      },\r\n      percentage: 0,\r\n      status: ''\r\n    }\r\n  },\r\n  created() {\r\n    this.requestData()\r\n  },\r\n  methods: {\r\n    handleWriting(couse_id, unit) {\r\n      this.$confirm('确定开启第' + unit + '单元任务', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消'\r\n      }).then(() => {\r\n        this.percentage = 0\r\n        this.status = ''\r\n        const timer = window.setInterval(e => {\r\n          const step = Math.ceil((100 - this.percentage) / 40)\r\n          if (this.percentage + step > 99) {\r\n            this.percentage = 99\r\n            clearInterval(timer)\r\n          } else {\r\n            this.percentage += step\r\n          }\r\n        }, 500)\r\n        this.visible1 = true\r\n         axios.get('http://autohomework.top/user/money', { params: {\r\n        // axios.get('http://127.0.0.1:3333/user/money', { params: {\r\n          couse_id: couse_id,\r\n          unit: unit,\r\n          operate: 2\r\n        }}).then(res => {\r\n          if (res.data.status == 1) {\r\n            this.$message({ message: '任务成功，已完成第' + unit + '单元', type: 'success' })\r\n            clearInterval(timer)\r\n            this.percentage = 100\r\n            this.status = 'success'\r\n            window.setTimeout(e => this.visible1 = false, 1000)\r\n            this.requestData()\r\n          } else if (res.data.status == 0) {\r\n            this.status = 'exception'\r\n            window.setTimeout(e => this.visible1 = false, 1000)\r\n            this.$message({ message: res.data.msg, type: 'warning' })\r\n          } else {\r\n            this.visible1 = false\r\n            this.$message.error('服务器异常，请稍后再试')\r\n          }\r\n        })\r\n      }).catch(() => {\r\n      })\r\n    },\r\n    requestData() {\r\n      getInfo().then(res => {\r\n        const user = eval('(' + res.data + ')')\r\n        this.user.coin = user.user_money\r\n        this.user.user_invited_tick = user.user_invited_tick\r\n         this.$store.dispatch('user/getInfo')\r\n      })\r\n        \r\n    }\r\n  }\r\n}\r\n",null]}